-- t 3275
CREATE PROCEDURE [dbo].[MakeLocation]
	@Address nvarchar(20),
	@Code nvarchar(15),
	@ParentAddress nvarchar(20),
	@IcCompanyCodes nvarchar(200)	
AS
	declare @LocationId int
	declare @ParentId int
	declare @HierarchiLevel int = 0
	declare @Path nvarchar(250)
	declare @PlainPath nvarchar(250)
	DECLARE @errMsg nvarchar(500)	
BEGIN

	SELECT @LocationId = LOCATION_ID from [dbo].[LOCATION] WHERE [ADDRESS] = @Address;

	if @LocationId is null
	begin
		select
			@ParentId = LOCATION_ID,
			@HierarchiLevel = HIERARCHY_LEVEL + 1,
			@PlainPath = IsNull([PLAIN_PATH],'|') + CODE +'|',
			@Path = IsNull([PATH],'|') + cast(LOCATION_ID as nvarchar(20)) + '|'
		from
			LOCATION
		where
			[ADDRESS] = @ParentAddress

		INSERT INTO [dbo].[LOCATION]
				([CODE]
				,[ADDRESS]
				,[STATUS]
				,[HAS_CHILDREN]
				,[HIERARCHY_LEVEL]
				,[PARENT_ID]
				,[PATH]
				,[PLAIN_PATH]
				,[CREATE_USER]
				,[CREATE_TIMESTAMP]
				,[UPDATE_USER]
				,[UPDATE_TIMESTAMP])
		 VALUES
			   (@Code
			   ,@Address
			   ,0
			   ,0
			   ,@HierarchiLevel
			   ,@ParentId
			   ,@Path
			   ,@PlainPath
			   ,'la180621'
			   ,getdate()
			   ,'la180621'
			   ,getdate())

		select @LocationId = SCOPE_IDENTITY();		   

		-- Update parent's "HasChildren" property
		UPDATE LOCATION
		SET HAS_CHILDREN = 1
		WHERE LOCATION_ID IN
		(
			SELECT PARENT_ID FROM LOCATION
			WHERE STATUS = 0 AND PARENT_ID IS NOT NULL AND PARENT_ID = @ParentId
			GROUP BY PARENT_ID
		)
	end
	
	--Insert locaiton for all internal companies
	IF @LocationId is not null and @IcCompanyCodes IS NOT NULL
	BEGIN
				 
		DECLARE @pos INT
		DECLARE @len INT
		DECLARE @value NVARCHAR(50)
		
		SET @pos = 0
		SET @len = 0
		SET @IcCompanyCodes = @IcCompanyCodes + ','
		
		WHILE CHARINDEX(',', @IcCompanyCodes, @pos+1)>0
		BEGIN
			SET @len = CHARINDEX(',', @IcCompanyCodes, @pos+1) - @pos
			SET @value = SUBSTRING(@IcCompanyCodes, @pos, @len)

			DECLARE @icId INT;
			SELECT @icId = COMPANY_ID from [dbo].[COMPANY] WHERE [CODE] = @value;
			
			--Check if the company exists
			IF (@icId is null)
			BEGIN
				;select @errMsg = 'Company with code ' + @value +' does not exist. Could not insert location.'
				;THROW 51000, @errMsg, 1;
			END

			--insert ic (if not exists) to location and recursively to all its parents 
			;WITH Loc(LOCATION_ID, PARENT_ID) AS	(
				select LOCATION_ID, PARENT_ID from LOCATION where LOCATION_ID = @LocationId
					union all
				select l.LOCATION_ID, l.PARENT_ID from LOCATION l join Loc on Loc.PARENT_ID = l.LOCATION_ID
			)
			INSERT INTO [dbo].[LOCATION_INTERNAL_COMPANY]
				([LOCATION_ID]
				,[INTERNAL_COMPANY_ID])
			SELECT
				LOCATION_ID, @icId
			from Loc
			WHERE NOT EXISTS (
				select * from LOCATION_INTERNAL_COMPANY WHERE
				LOCATION_ID = Loc.LOCATION_ID and INTERNAL_COMPANY_ID = @icId
			)				
				
			SET @pos = CHARINDEX(',', @IcCompanyCodes, @pos+@len) + 1

		END		
		
	END	

END
go

set nocount on


exec MakeLocation 'FSOA','A','FSO','MHZ'
exec MakeLocation 'FSOB','B','FSO','MHZ'
exec MakeLocation 'FSOC','C','FSO','MHZ'
exec MakeLocation 'FSOD','D','FSO','MHZ'

exec MakeLocation 'FSOA001','001','FSOA','MHZ'
exec MakeLocation 'FSOA002','002','FSOA','MHZ'
exec MakeLocation 'FSOA003','003','FSOA','MHZ'
exec MakeLocation 'FSOA004','004','FSOA','MHZ'
exec MakeLocation 'FSOA005','005','FSOA','MHZ'
exec MakeLocation 'FSOA006','006','FSOA','MHZ'
exec MakeLocation 'FSOA007','007','FSOA','MHZ'
exec MakeLocation 'FSOA008','008','FSOA','MHZ'
exec MakeLocation 'FSOA009','009','FSOA','MHZ'
exec MakeLocation 'FSOA010','010','FSOA','MHZ'
exec MakeLocation 'FSOA011','011','FSOA','MHZ'
exec MakeLocation 'FSOA012','012','FSOA','MHZ'
exec MakeLocation 'FSOA013','013','FSOA','MHZ'
exec MakeLocation 'FSOA014','014','FSOA','MHZ'
exec MakeLocation 'FSOA015','015','FSOA','MHZ'
exec MakeLocation 'FSOA016','016','FSOA','MHZ'
exec MakeLocation 'FSOA017','017','FSOA','MHZ'
exec MakeLocation 'FSOA018','018','FSOA','MHZ'
exec MakeLocation 'FSOA019','019','FSOA','MHZ'
exec MakeLocation 'FSOA020','020','FSOA','MHZ'
exec MakeLocation 'FSOA021','021','FSOA','MHZ'
exec MakeLocation 'FSOA022','022','FSOA','MHZ'
exec MakeLocation 'FSOA023','023','FSOA','MHZ'
exec MakeLocation 'FSOA024','024','FSOA','MHZ'
exec MakeLocation 'FSOA025','025','FSOA','MHZ'
exec MakeLocation 'FSOA026','026','FSOA','MHZ'
exec MakeLocation 'FSOA027','027','FSOA','MHZ'
exec MakeLocation 'FSOA028','028','FSOA','MHZ'
exec MakeLocation 'FSOA029','029','FSOA','MHZ'
exec MakeLocation 'FSOA030','030','FSOA','MHZ'
exec MakeLocation 'FSOA031','031','FSOA','MHZ'
exec MakeLocation 'FSOA032','032','FSOA','MHZ'
exec MakeLocation 'FSOA033','033','FSOA','MHZ'
exec MakeLocation 'FSOA034','034','FSOA','MHZ'
exec MakeLocation 'FSOA035','035','FSOA','MHZ'
exec MakeLocation 'FSOA036','036','FSOA','MHZ'
exec MakeLocation 'FSOA037','037','FSOA','MHZ'
exec MakeLocation 'FSOA038','038','FSOA','MHZ'
exec MakeLocation 'FSOA039','039','FSOA','MHZ'
exec MakeLocation 'FSOA040','040','FSOA','MHZ'
exec MakeLocation 'FSOA041','041','FSOA','MHZ'
exec MakeLocation 'FSOA042','042','FSOA','MHZ'
exec MakeLocation 'FSOA043','043','FSOA','MHZ'
exec MakeLocation 'FSOA044','044','FSOA','MHZ'
exec MakeLocation 'FSOA045','045','FSOA','MHZ'
exec MakeLocation 'FSOA046','046','FSOA','MHZ'
exec MakeLocation 'FSOA047','047','FSOA','MHZ'
exec MakeLocation 'FSOA048','048','FSOA','MHZ'
exec MakeLocation 'FSOA049','049','FSOA','MHZ'
exec MakeLocation 'FSOA050','050','FSOA','MHZ'
exec MakeLocation 'FSOA051','051','FSOA','MHZ'
exec MakeLocation 'FSOA052','052','FSOA','MHZ'
exec MakeLocation 'FSOA053','053','FSOA','MHZ'
exec MakeLocation 'FSOA054','054','FSOA','MHZ'
exec MakeLocation 'FSOA055','055','FSOA','MHZ'
exec MakeLocation 'FSOA056','056','FSOA','MHZ'
exec MakeLocation 'FSOA057','057','FSOA','MHZ'
exec MakeLocation 'FSOA058','058','FSOA','MHZ'
exec MakeLocation 'FSOB001','001','FSOB','MHZ'
exec MakeLocation 'FSOB002','002','FSOB','MHZ'
exec MakeLocation 'FSOB003','003','FSOB','MHZ'
exec MakeLocation 'FSOB004','004','FSOB','MHZ'
exec MakeLocation 'FSOB005','005','FSOB','MHZ'
exec MakeLocation 'FSOB006','006','FSOB','MHZ'
exec MakeLocation 'FSOB007','007','FSOB','MHZ'
exec MakeLocation 'FSOB008','008','FSOB','MHZ'
exec MakeLocation 'FSOB009','009','FSOB','MHZ'
exec MakeLocation 'FSOB010','010','FSOB','MHZ'
exec MakeLocation 'FSOB011','011','FSOB','MHZ'
exec MakeLocation 'FSOB012','012','FSOB','MHZ'
exec MakeLocation 'FSOB013','013','FSOB','MHZ'
exec MakeLocation 'FSOB014','014','FSOB','MHZ'
exec MakeLocation 'FSOB015','015','FSOB','MHZ'
exec MakeLocation 'FSOB016','016','FSOB','MHZ'
exec MakeLocation 'FSOB017','017','FSOB','MHZ'
exec MakeLocation 'FSOB018','018','FSOB','MHZ'
exec MakeLocation 'FSOB019','019','FSOB','MHZ'
exec MakeLocation 'FSOB020','020','FSOB','MHZ'
exec MakeLocation 'FSOB021','021','FSOB','MHZ'
exec MakeLocation 'FSOB022','022','FSOB','MHZ'
exec MakeLocation 'FSOB023','023','FSOB','MHZ'
exec MakeLocation 'FSOB024','024','FSOB','MHZ'
exec MakeLocation 'FSOB025','025','FSOB','MHZ'
exec MakeLocation 'FSOB026','026','FSOB','MHZ'
exec MakeLocation 'FSOB027','027','FSOB','MHZ'
exec MakeLocation 'FSOB028','028','FSOB','MHZ'
exec MakeLocation 'FSOB029','029','FSOB','MHZ'
exec MakeLocation 'FSOB030','030','FSOB','MHZ'
exec MakeLocation 'FSOB031','031','FSOB','MHZ'
exec MakeLocation 'FSOB032','032','FSOB','MHZ'
exec MakeLocation 'FSOB033','033','FSOB','MHZ'
exec MakeLocation 'FSOB034','034','FSOB','MHZ'
exec MakeLocation 'FSOB035','035','FSOB','MHZ'
exec MakeLocation 'FSOB036','036','FSOB','MHZ'
exec MakeLocation 'FSOB037','037','FSOB','MHZ'
exec MakeLocation 'FSOB038','038','FSOB','MHZ'
exec MakeLocation 'FSOB039','039','FSOB','MHZ'
exec MakeLocation 'FSOB040','040','FSOB','MHZ'
exec MakeLocation 'FSOB041','041','FSOB','MHZ'
exec MakeLocation 'FSOB042','042','FSOB','MHZ'
exec MakeLocation 'FSOB043','043','FSOB','MHZ'
exec MakeLocation 'FSOB044','044','FSOB','MHZ'
exec MakeLocation 'FSOB045','045','FSOB','MHZ'
exec MakeLocation 'FSOB046','046','FSOB','MHZ'
exec MakeLocation 'FSOB047','047','FSOB','MHZ'
exec MakeLocation 'FSOB048','048','FSOB','MHZ'
exec MakeLocation 'FSOB049','049','FSOB','MHZ'
exec MakeLocation 'FSOB050','050','FSOB','MHZ'
exec MakeLocation 'FSOB051','051','FSOB','MHZ'
exec MakeLocation 'FSOB052','052','FSOB','MHZ'
exec MakeLocation 'FSOB053','053','FSOB','MHZ'
exec MakeLocation 'FSOB054','054','FSOB','MHZ'
exec MakeLocation 'FSOB055','055','FSOB','MHZ'
exec MakeLocation 'FSOB056','056','FSOB','MHZ'
exec MakeLocation 'FSOB057','057','FSOB','MHZ'
exec MakeLocation 'FSOB058','058','FSOB','MHZ'
exec MakeLocation 'FSOB059','059','FSOB','MHZ'
exec MakeLocation 'FSOB060','060','FSOB','MHZ'
exec MakeLocation 'FSOB061','061','FSOB','MHZ'
exec MakeLocation 'FSOB062','062','FSOB','MHZ'
exec MakeLocation 'FSOB063','063','FSOB','MHZ'
exec MakeLocation 'FSOB064','064','FSOB','MHZ'
exec MakeLocation 'FSOB065','065','FSOB','MHZ'
exec MakeLocation 'FSOB066','066','FSOB','MHZ'
exec MakeLocation 'FSOB067','067','FSOB','MHZ'
exec MakeLocation 'FSOB068','068','FSOB','MHZ'
exec MakeLocation 'FSOB069','069','FSOB','MHZ'
exec MakeLocation 'FSOB070','070','FSOB','MHZ'
exec MakeLocation 'FSOB071','071','FSOB','MHZ'
exec MakeLocation 'FSOB072','072','FSOB','MHZ'
exec MakeLocation 'FSOB073','073','FSOB','MHZ'
exec MakeLocation 'FSOB074','074','FSOB','MHZ'
exec MakeLocation 'FSOC001','001','FSOC','MHZ'
exec MakeLocation 'FSOC002','002','FSOC','MHZ'
exec MakeLocation 'FSOC003','003','FSOC','MHZ'
exec MakeLocation 'FSOC004','004','FSOC','MHZ'
exec MakeLocation 'FSOC005','005','FSOC','MHZ'
exec MakeLocation 'FSOC006','006','FSOC','MHZ'
exec MakeLocation 'FSOC007','007','FSOC','MHZ'
exec MakeLocation 'FSOC008','008','FSOC','MHZ'
exec MakeLocation 'FSOC009','009','FSOC','MHZ'
exec MakeLocation 'FSOC010','010','FSOC','MHZ'
exec MakeLocation 'FSOC011','011','FSOC','MHZ'
exec MakeLocation 'FSOC012','012','FSOC','MHZ'
exec MakeLocation 'FSOC013','013','FSOC','MHZ'
exec MakeLocation 'FSOC014','014','FSOC','MHZ'
exec MakeLocation 'FSOC015','015','FSOC','MHZ'
exec MakeLocation 'FSOC016','016','FSOC','MHZ'
exec MakeLocation 'FSOC017','017','FSOC','MHZ'
exec MakeLocation 'FSOC018','018','FSOC','MHZ'
exec MakeLocation 'FSOC019','019','FSOC','MHZ'
exec MakeLocation 'FSOC020','020','FSOC','MHZ'
exec MakeLocation 'FSOC021','021','FSOC','MHZ'
exec MakeLocation 'FSOC022','022','FSOC','MHZ'
exec MakeLocation 'FSOC023','023','FSOC','MHZ'
exec MakeLocation 'FSOC024','024','FSOC','MHZ'
exec MakeLocation 'FSOC025','025','FSOC','MHZ'
exec MakeLocation 'FSOC026','026','FSOC','MHZ'
exec MakeLocation 'FSOC027','027','FSOC','MHZ'
exec MakeLocation 'FSOC028','028','FSOC','MHZ'
exec MakeLocation 'FSOC029','029','FSOC','MHZ'
exec MakeLocation 'FSOD001','001','FSOD','MHZ'
exec MakeLocation 'FSOD002','002','FSOD','MHZ'
exec MakeLocation 'FSOD003','003','FSOD','MHZ'
exec MakeLocation 'FSOD004','004','FSOD','MHZ'
exec MakeLocation 'FSOD005','005','FSOD','MHZ'
exec MakeLocation 'FSOD006','006','FSOD','MHZ'
exec MakeLocation 'FSOD007','007','FSOD','MHZ'
exec MakeLocation 'FSOD008','008','FSOD','MHZ'
exec MakeLocation 'FSOD009','009','FSOD','MHZ'
exec MakeLocation 'FSOD010','010','FSOD','MHZ'
exec MakeLocation 'FSOD011','011','FSOD','MHZ'
exec MakeLocation 'FSOD012','012','FSOD','MHZ'
exec MakeLocation 'FSOD013','013','FSOD','MHZ'
exec MakeLocation 'FSOD014','014','FSOD','MHZ'
exec MakeLocation 'FSOD015','015','FSOD','MHZ'
exec MakeLocation 'FSOD016','016','FSOD','MHZ'
exec MakeLocation 'FSOD017','017','FSOD','MHZ'
exec MakeLocation 'FSOD018','018','FSOD','MHZ'
exec MakeLocation 'FSOD019','019','FSOD','MHZ'
exec MakeLocation 'FSOD020','020','FSOD','MHZ'
exec MakeLocation 'FSOD021','021','FSOD','MHZ'
exec MakeLocation 'FSOD022','022','FSOD','MHZ'
exec MakeLocation 'FSOD023','023','FSOD','MHZ'
exec MakeLocation 'FSOD024','024','FSOD','MHZ'
exec MakeLocation 'FSOD025','025','FSOD','MHZ'
exec MakeLocation 'FSOD026','026','FSOD','MHZ'
exec MakeLocation 'FSOD027','027','FSOD','MHZ'
exec MakeLocation 'FSOD028','028','FSOD','MHZ'
exec MakeLocation 'FSOD029','029','FSOD','MHZ'
exec MakeLocation 'FSOD030','030','FSOD','MHZ'
exec MakeLocation 'FSOD031','031','FSOD','MHZ'
exec MakeLocation 'FSOD032','032','FSOD','MHZ'
exec MakeLocation 'FSOD033','033','FSOD','MHZ'
exec MakeLocation 'FSOD034','034','FSOD','MHZ'
exec MakeLocation 'FSOD035','035','FSOD','MHZ'
exec MakeLocation 'FSOD036','036','FSOD','MHZ'
exec MakeLocation 'FSOD037','037','FSOD','MHZ'
exec MakeLocation 'FSOD038','038','FSOD','MHZ'
exec MakeLocation 'FSOD039','039','FSOD','MHZ'
exec MakeLocation 'FSOD040','040','FSOD','MHZ'
exec MakeLocation 'FSOD041','041','FSOD','MHZ'
exec MakeLocation 'FSOD042','042','FSOD','MHZ'
exec MakeLocation 'FSOD043','043','FSOD','MHZ'
exec MakeLocation 'FSOD044','044','FSOD','MHZ'
exec MakeLocation 'FSOD045','045','FSOD','MHZ'
exec MakeLocation 'FSOD046','046','FSOD','MHZ'
exec MakeLocation 'FSOD047','047','FSOD','MHZ'
exec MakeLocation 'FSOD048','048','FSOD','MHZ'
exec MakeLocation 'FSOD049','049','FSOD','MHZ'
exec MakeLocation 'FSOD050','050','FSOD','MHZ'
exec MakeLocation 'FSOD051','051','FSOD','MHZ'
exec MakeLocation 'FSOD052','052','FSOD','MHZ'
exec MakeLocation 'FSOD053','053','FSOD','MHZ'
exec MakeLocation 'FSOD054','054','FSOD','MHZ'


exec MakeLocation 'FSPP502','502','FSPP','MHZ'
exec MakeLocation 'FSPP503','503','FSPP','MHZ'
exec MakeLocation 'FSPP504','504','FSPP','MHZ'
exec MakeLocation 'FSPP505','505','FSPP','MHZ'
exec MakeLocation 'FSPP506','506','FSPP','MHZ'
exec MakeLocation 'FSPP507','507','FSPP','MHZ'
exec MakeLocation 'FSPP508','508','FSPP','MHZ'
exec MakeLocation 'FSPP509','509','FSPP','MHZ'
exec MakeLocation 'FSPP510','510','FSPP','MHZ'
exec MakeLocation 'FSPP511','511','FSPP','MHZ'
exec MakeLocation 'FSPP512','512','FSPP','MHZ'
exec MakeLocation 'FSPP513','513','FSPP','MHZ'
exec MakeLocation 'FSPP514','514','FSPP','MHZ'
exec MakeLocation 'FSPP515','515','FSPP','MHZ'
exec MakeLocation 'FSPP516','516','FSPP','MHZ'
exec MakeLocation 'FSPP517','517','FSPP','MHZ'
exec MakeLocation 'FSPP518','518','FSPP','MHZ'
exec MakeLocation 'FSPP519','519','FSPP','MHZ'
exec MakeLocation 'FSPP520','520','FSPP','MHZ'
exec MakeLocation 'FSPP521','521','FSPP','MHZ'
exec MakeLocation 'FSPP522','522','FSPP','MHZ'
exec MakeLocation 'FSPP523','523','FSPP','MHZ'
exec MakeLocation 'FSPP524','524','FSPP','MHZ'
exec MakeLocation 'FSPP525','525','FSPP','MHZ'
exec MakeLocation 'FSPP526','526','FSPP','MHZ'
exec MakeLocation 'FSPP527','527','FSPP','MHZ'
exec MakeLocation 'FSPP528','528','FSPP','MHZ'
exec MakeLocation 'FSPP529','529','FSPP','MHZ'
exec MakeLocation 'FSPP530','530','FSPP','MHZ'
exec MakeLocation 'FSPP531','531','FSPP','MHZ'
exec MakeLocation 'FSPP532','532','FSPP','MHZ'
exec MakeLocation 'FSPP533','533','FSPP','MHZ'
exec MakeLocation 'FSPP534','534','FSPP','MHZ'
exec MakeLocation 'FSPP535','535','FSPP','MHZ'
exec MakeLocation 'FSPP536','536','FSPP','MHZ'
exec MakeLocation 'FSPP537','537','FSPP','MHZ'
exec MakeLocation 'FSPP538','538','FSPP','MHZ'
exec MakeLocation 'FSPP539','539','FSPP','MHZ'
exec MakeLocation 'FSPP540','540','FSPP','MHZ'
exec MakeLocation 'FSPP541','541','FSPP','MHZ'
exec MakeLocation 'FSPP542','542','FSPP','MHZ'
exec MakeLocation 'FSPP543','543','FSPP','MHZ'
exec MakeLocation 'FSPP544','544','FSPP','MHZ'
exec MakeLocation 'FSPP545','545','FSPP','MHZ'
exec MakeLocation 'FSPP546','546','FSPP','MHZ'
exec MakeLocation 'FSPP547','547','FSPP','MHZ'
exec MakeLocation 'FSPP548','548','FSPP','MHZ'
exec MakeLocation 'FSPP549','549','FSPP','MHZ'
exec MakeLocation 'FSPP550','550','FSPP','MHZ'
exec MakeLocation 'FSPP551','551','FSPP','MHZ'
exec MakeLocation 'FSPP552','552','FSPP','MHZ'
exec MakeLocation 'FSPP553','553','FSPP','MHZ'
exec MakeLocation 'FSPP554','554','FSPP','MHZ'
exec MakeLocation 'FSPP555','555','FSPP','MHZ'
exec MakeLocation 'FSPP556','556','FSPP','MHZ'
exec MakeLocation 'FSPP557','557','FSPP','MHZ'
exec MakeLocation 'FSPP558','558','FSPP','MHZ'
exec MakeLocation 'FSPP559','559','FSPP','MHZ'
exec MakeLocation 'FSPP560','560','FSPP','MHZ'
exec MakeLocation 'FSPP561','561','FSPP','MHZ'
exec MakeLocation 'FSPP562','562','FSPP','MHZ'
exec MakeLocation 'FSPP563','563','FSPP','MHZ'
exec MakeLocation 'FSPP564','564','FSPP','MHZ'
exec MakeLocation 'FSPP565','565','FSPP','MHZ'
exec MakeLocation 'FSPP566','566','FSPP','MHZ'
exec MakeLocation 'FSPP567','567','FSPP','MHZ'
exec MakeLocation 'FSPP568','568','FSPP','MHZ'
exec MakeLocation 'FSPP569','569','FSPP','MHZ'
exec MakeLocation 'FSPP570','570','FSPP','MHZ'
exec MakeLocation 'FSPP571','571','FSPP','MHZ'
exec MakeLocation 'FSPP572','572','FSPP','MHZ'
exec MakeLocation 'FSPP573','573','FSPP','MHZ'
exec MakeLocation 'FSPP574','574','FSPP','MHZ'
exec MakeLocation 'FSPP575','575','FSPP','MHZ'
exec MakeLocation 'FSPP576','576','FSPP','MHZ'
exec MakeLocation 'FSPP577','577','FSPP','MHZ'
exec MakeLocation 'FSPP578','578','FSPP','MHZ'
exec MakeLocation 'FSPP579','579','FSPP','MHZ'
exec MakeLocation 'FSPP580','580','FSPP','MHZ'
exec MakeLocation 'FSPP581','581','FSPP','MHZ'
exec MakeLocation 'FSPP582','582','FSPP','MHZ'
exec MakeLocation 'FSPP583','583','FSPP','MHZ'
exec MakeLocation 'FSPP584','584','FSPP','MHZ'
exec MakeLocation 'FSPP585','585','FSPP','MHZ'
exec MakeLocation 'FSPP586','586','FSPP','MHZ'
exec MakeLocation 'FSPP587','587','FSPP','MHZ'
exec MakeLocation 'FSPP588','588','FSPP','MHZ'
exec MakeLocation 'FSPP589','589','FSPP','MHZ'
exec MakeLocation 'FSPP590','590','FSPP','MHZ'
exec MakeLocation 'FSPP591','591','FSPP','MHZ'
exec MakeLocation 'FSPP592','592','FSPP','MHZ'
exec MakeLocation 'FSPP593','593','FSPP','MHZ'
exec MakeLocation 'FSPP594','594','FSPP','MHZ'
exec MakeLocation 'FSPP595','595','FSPP','MHZ'
exec MakeLocation 'FSPP596','596','FSPP','MHZ'
exec MakeLocation 'FSPP597','597','FSPP','MHZ'
exec MakeLocation 'FSPP598','598','FSPP','MHZ'
exec MakeLocation 'FSPP599','599','FSPP','MHZ'
exec MakeLocation 'FSPP600','600','FSPP','MHZ'
exec MakeLocation 'FSPP601','601','FSPP','MHZ'
exec MakeLocation 'FSPP602','602','FSPP','MHZ'
exec MakeLocation 'FSPP603','603','FSPP','MHZ'
exec MakeLocation 'FSPP604','604','FSPP','MHZ'
exec MakeLocation 'FSPP605','605','FSPP','MHZ'
exec MakeLocation 'FSPP606','606','FSPP','MHZ'
exec MakeLocation 'FSPP607','607','FSPP','MHZ'
exec MakeLocation 'FSPP608','608','FSPP','MHZ'
exec MakeLocation 'FSPP609','609','FSPP','MHZ'
exec MakeLocation 'FSPP610','610','FSPP','MHZ'
exec MakeLocation 'FSPP611','611','FSPP','MHZ'
exec MakeLocation 'FSPP612','612','FSPP','MHZ'
exec MakeLocation 'FSPP613','613','FSPP','MHZ'
exec MakeLocation 'FSPP614','614','FSPP','MHZ'
exec MakeLocation 'FSPP615','615','FSPP','MHZ'
exec MakeLocation 'FSPP616','616','FSPP','MHZ'
exec MakeLocation 'FSPP617','617','FSPP','MHZ'
exec MakeLocation 'FSPP618','618','FSPP','MHZ'
exec MakeLocation 'FSPP619','619','FSPP','MHZ'
exec MakeLocation 'FSPP620','620','FSPP','MHZ'
exec MakeLocation 'FSPP621','621','FSPP','MHZ'
exec MakeLocation 'FSPP622','622','FSPP','MHZ'
exec MakeLocation 'FSPP623','623','FSPP','MHZ'
exec MakeLocation 'FSPP624','624','FSPP','MHZ'
exec MakeLocation 'FSPP625','625','FSPP','MHZ'
exec MakeLocation 'FSPP626','626','FSPP','MHZ'
exec MakeLocation 'FSPP627','627','FSPP','MHZ'
exec MakeLocation 'FSPP628','628','FSPP','MHZ'
exec MakeLocation 'FSPP629','629','FSPP','MHZ'
exec MakeLocation 'FSPP630','630','FSPP','MHZ'
exec MakeLocation 'FSPP631','631','FSPP','MHZ'
exec MakeLocation 'FSPP632','632','FSPP','MHZ'
exec MakeLocation 'FSPP633','633','FSPP','MHZ'
exec MakeLocation 'FSPP634','634','FSPP','MHZ'
exec MakeLocation 'FSPP635','635','FSPP','MHZ'
exec MakeLocation 'FSPP636','636','FSPP','MHZ'
exec MakeLocation 'FSPP637','637','FSPP','MHZ'
exec MakeLocation 'FSPP638','638','FSPP','MHZ'
exec MakeLocation 'FSPP639','639','FSPP','MHZ'
exec MakeLocation 'FSPP640','640','FSPP','MHZ'
exec MakeLocation 'FSPP641','641','FSPP','MHZ'
exec MakeLocation 'FSPP642','642','FSPP','MHZ'
exec MakeLocation 'FSPP643','643','FSPP','MHZ'
exec MakeLocation 'FSPP644','644','FSPP','MHZ'
exec MakeLocation 'FSPP645','645','FSPP','MHZ'
exec MakeLocation 'FSPP646','646','FSPP','MHZ'
exec MakeLocation 'FSPP647','647','FSPP','MHZ'
exec MakeLocation 'FSPP648','648','FSPP','MHZ'
exec MakeLocation 'FSPP649','649','FSPP','MHZ'
exec MakeLocation 'FSPP650','650','FSPP','MHZ'
exec MakeLocation 'FSPP651','651','FSPP','MHZ'
exec MakeLocation 'FSPP652','652','FSPP','MHZ'
exec MakeLocation 'FSPP653','653','FSPP','MHZ'
exec MakeLocation 'FSPP654','654','FSPP','MHZ'
exec MakeLocation 'FSPP655','655','FSPP','MHZ'
exec MakeLocation 'FSPP656','656','FSPP','MHZ'
exec MakeLocation 'FSPP657','657','FSPP','MHZ'
exec MakeLocation 'FSPP658','658','FSPP','MHZ'
exec MakeLocation 'FSPP659','659','FSPP','MHZ'
exec MakeLocation 'FSPP660','660','FSPP','MHZ'
exec MakeLocation 'FSPP661','661','FSPP','MHZ'
exec MakeLocation 'FSPP662','662','FSPP','MHZ'
exec MakeLocation 'FSPP663','663','FSPP','MHZ'
exec MakeLocation 'FSPP664','664','FSPP','MHZ'
exec MakeLocation 'FSPP665','665','FSPP','MHZ'
exec MakeLocation 'FSPP666','666','FSPP','MHZ'
exec MakeLocation 'FSPP667','667','FSPP','MHZ'
exec MakeLocation 'FSPP668','668','FSPP','MHZ'
exec MakeLocation 'FSPP669','669','FSPP','MHZ'
exec MakeLocation 'FSPP670','670','FSPP','MHZ'
exec MakeLocation 'FSPP671','671','FSPP','MHZ'
exec MakeLocation 'FSPP672','672','FSPP','MHZ'
exec MakeLocation 'FSPP673','673','FSPP','MHZ'
exec MakeLocation 'FSPP674','674','FSPP','MHZ'
exec MakeLocation 'FSPP675','675','FSPP','MHZ'
exec MakeLocation 'FSPP676','676','FSPP','MHZ'
exec MakeLocation 'FSPP677','677','FSPP','MHZ'
exec MakeLocation 'FSPP678','678','FSPP','MHZ'
exec MakeLocation 'FSPP679','679','FSPP','MHZ'
exec MakeLocation 'FSPP680','680','FSPP','MHZ'
exec MakeLocation 'FSPP681','681','FSPP','MHZ'
exec MakeLocation 'FSPP682','682','FSPP','MHZ'
exec MakeLocation 'FSPP683','683','FSPP','MHZ'
exec MakeLocation 'FSPP684','684','FSPP','MHZ'
exec MakeLocation 'FSPP685','685','FSPP','MHZ'
exec MakeLocation 'FSPP686','686','FSPP','MHZ'
exec MakeLocation 'FSPP687','687','FSPP','MHZ'
exec MakeLocation 'FSPP688','688','FSPP','MHZ'
exec MakeLocation 'FSPP689','689','FSPP','MHZ'
exec MakeLocation 'FSPP690','690','FSPP','MHZ'
exec MakeLocation 'FSPP691','691','FSPP','MHZ'
exec MakeLocation 'FSPP692','692','FSPP','MHZ'
exec MakeLocation 'FSPP693','693','FSPP','MHZ'
exec MakeLocation 'FSPP694','694','FSPP','MHZ'
exec MakeLocation 'FSPP695','695','FSPP','MHZ'
exec MakeLocation 'FSPP696','696','FSPP','MHZ'
exec MakeLocation 'FSPP697','697','FSPP','MHZ'
exec MakeLocation 'FSPP698','698','FSPP','MHZ'
exec MakeLocation 'FSPP699','699','FSPP','MHZ'
exec MakeLocation 'FSPP700','700','FSPP','MHZ'
exec MakeLocation 'FSPP701','701','FSPP','MHZ'
exec MakeLocation 'FSPP702','702','FSPP','MHZ'
exec MakeLocation 'FSPP703','703','FSPP','MHZ'
exec MakeLocation 'FSPP704','704','FSPP','MHZ'
exec MakeLocation 'FSPP705','705','FSPP','MHZ'
exec MakeLocation 'FSPP706','706','FSPP','MHZ'
exec MakeLocation 'FSPP707','707','FSPP','MHZ'
exec MakeLocation 'FSPP708','708','FSPP','MHZ'
exec MakeLocation 'FSPP709','709','FSPP','MHZ'
exec MakeLocation 'FSPP710','710','FSPP','MHZ'
exec MakeLocation 'FSPP711','711','FSPP','MHZ'
exec MakeLocation 'FSPP712','712','FSPP','MHZ'
exec MakeLocation 'FSPP713','713','FSPP','MHZ'
exec MakeLocation 'FSPP714','714','FSPP','MHZ'
exec MakeLocation 'FSPP715','715','FSPP','MHZ'
exec MakeLocation 'FSPP716','716','FSPP','MHZ'
exec MakeLocation 'FSPP717','717','FSPP','MHZ'
exec MakeLocation 'FSPP718','718','FSPP','MHZ'
exec MakeLocation 'FSPP719','719','FSPP','MHZ'
exec MakeLocation 'FSPP720','720','FSPP','MHZ'
exec MakeLocation 'FSPP721','721','FSPP','MHZ'
exec MakeLocation 'FSPP722','722','FSPP','MHZ'
exec MakeLocation 'FSPP723','723','FSPP','MHZ'
exec MakeLocation 'FSPP724','724','FSPP','MHZ'
exec MakeLocation 'FSPP725','725','FSPP','MHZ'
exec MakeLocation 'FSPP726','726','FSPP','MHZ'
exec MakeLocation 'FSPP727','727','FSPP','MHZ'
exec MakeLocation 'FSPP728','728','FSPP','MHZ'
exec MakeLocation 'FSPP729','729','FSPP','MHZ'
exec MakeLocation 'FSPP730','730','FSPP','MHZ'
exec MakeLocation 'FSPP731','731','FSPP','MHZ'
exec MakeLocation 'FSPP732','732','FSPP','MHZ'
exec MakeLocation 'FSPP733','733','FSPP','MHZ'
exec MakeLocation 'FSPP734','734','FSPP','MHZ'
exec MakeLocation 'FSPP735','735','FSPP','MHZ'
exec MakeLocation 'FSPP736','736','FSPP','MHZ'
exec MakeLocation 'FSPP737','737','FSPP','MHZ'
exec MakeLocation 'FSPP738','738','FSPP','MHZ'
exec MakeLocation 'FSPP739','739','FSPP','MHZ'
exec MakeLocation 'FSPP740','740','FSPP','MHZ'
exec MakeLocation 'FSPP741','741','FSPP','MHZ'
exec MakeLocation 'FSPP742','742','FSPP','MHZ'
exec MakeLocation 'FSPP743','743','FSPP','MHZ'
exec MakeLocation 'FSPP744','744','FSPP','MHZ'
exec MakeLocation 'FSPP745','745','FSPP','MHZ'
exec MakeLocation 'FSPP746','746','FSPP','MHZ'
exec MakeLocation 'FSPP747','747','FSPP','MHZ'
exec MakeLocation 'FSPP748','748','FSPP','MHZ'
exec MakeLocation 'FSPP749','749','FSPP','MHZ'
exec MakeLocation 'FSPP750','750','FSPP','MHZ'
exec MakeLocation 'FSPP751','751','FSPP','MHZ'
exec MakeLocation 'FSPP752','752','FSPP','MHZ'
exec MakeLocation 'FSPP753','753','FSPP','MHZ'
exec MakeLocation 'FSPP754','754','FSPP','MHZ'
exec MakeLocation 'FSPP755','755','FSPP','MHZ'
exec MakeLocation 'FSPP756','756','FSPP','MHZ'
exec MakeLocation 'FSPP757','757','FSPP','MHZ'
exec MakeLocation 'FSPP758','758','FSPP','MHZ'
exec MakeLocation 'FSPP759','759','FSPP','MHZ'
exec MakeLocation 'FSPP760','760','FSPP','MHZ'
exec MakeLocation 'FSPP761','761','FSPP','MHZ'
exec MakeLocation 'FSPP762','762','FSPP','MHZ'
exec MakeLocation 'FSPP763','763','FSPP','MHZ'
exec MakeLocation 'FSPP764','764','FSPP','MHZ'
exec MakeLocation 'FSPP765','765','FSPP','MHZ'
exec MakeLocation 'FSPP766','766','FSPP','MHZ'
exec MakeLocation 'FSPP767','767','FSPP','MHZ'
exec MakeLocation 'FSPP768','768','FSPP','MHZ'
exec MakeLocation 'FSPP769','769','FSPP','MHZ'
exec MakeLocation 'FSPP770','770','FSPP','MHZ'
exec MakeLocation 'FSPP771','771','FSPP','MHZ'
exec MakeLocation 'FSPP772','772','FSPP','MHZ'
exec MakeLocation 'FSPP773','773','FSPP','MHZ'
exec MakeLocation 'FSPP774','774','FSPP','MHZ'
exec MakeLocation 'FSPP775','775','FSPP','MHZ'
exec MakeLocation 'FSPP776','776','FSPP','MHZ'
exec MakeLocation 'FSPP777','777','FSPP','MHZ'
exec MakeLocation 'FSPP778','778','FSPP','MHZ'
exec MakeLocation 'FSPP779','779','FSPP','MHZ'
exec MakeLocation 'FSPP780','780','FSPP','MHZ'
exec MakeLocation 'FSPP781','781','FSPP','MHZ'
exec MakeLocation 'FSPP782','782','FSPP','MHZ'
exec MakeLocation 'FSPP783','783','FSPP','MHZ'
exec MakeLocation 'FSPP784','784','FSPP','MHZ'
exec MakeLocation 'FSPP785','785','FSPP','MHZ'
exec MakeLocation 'FSPP786','786','FSPP','MHZ'
exec MakeLocation 'FSPP787','787','FSPP','MHZ'
exec MakeLocation 'FSPP788','788','FSPP','MHZ'
exec MakeLocation 'FSPP789','789','FSPP','MHZ'
exec MakeLocation 'FSPP790','790','FSPP','MHZ'
exec MakeLocation 'FSPP791','791','FSPP','MHZ'
exec MakeLocation 'FSPP792','792','FSPP','MHZ'
exec MakeLocation 'FSPP793','793','FSPP','MHZ'
exec MakeLocation 'FSPP794','794','FSPP','MHZ'
exec MakeLocation 'FSPP795','795','FSPP','MHZ'
exec MakeLocation 'FSPP796','796','FSPP','MHZ'
exec MakeLocation 'FSPP797','797','FSPP','MHZ'
exec MakeLocation 'FSPP798','798','FSPP','MHZ'
exec MakeLocation 'FSPP799','799','FSPP','MHZ'
exec MakeLocation 'FSPP800','800','FSPP','MHZ'


set nocount off
drop proc [dbo].[MakeLocation]
